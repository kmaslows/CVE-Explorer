package kamil.cve;

import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Component;

import javax.swing.JLabel;
import javax.swing.JList;
import javax.swing.JPanel;
import javax.swing.JTextArea;
import javax.swing.ListCellRenderer;

/**
 * Cell renderer class for CVE entries in CVE list.
 * @author Kamil Mas³owski
 *
 */
public class CVEListEntryRenderer extends JPanel implements ListCellRenderer {

	private static final long serialVersionUID = 1L;
	// cell elements
	private JLabel date;
	private JLabel title;
	private JTextArea summary; 

	/**
	 * Default constructor. It will create and set up all elements in cell view.
	 */
	public CVEListEntryRenderer() {
		// Add and set date label
		date = new JLabel();
		date.setHorizontalAlignment(JLabel.CENTER);
		
		// Add set title label
		title = new JLabel();
		title.setOpaque(true);
		title.setHorizontalAlignment(JLabel.CENTER);
		
		// Add and set summary
		summary = new JTextArea(5,50);
		summary.setLineWrap(true);
		summary.setWrapStyleWord(true);
		summary.setOpaque(false);
		
		// Set cell layout
		setLayout(new BorderLayout());

		// add elements to the cell
		add(date, BorderLayout.CENTER);
		add(summary, BorderLayout.SOUTH);
		add(title, BorderLayout.NORTH);
		
		// draw all pixels
		setOpaque(true);
	}

	/**
	 * Update cell view
	 */
	public Component getListCellRendererComponent(JList list, Object value, int index, boolean isSelected, boolean cellHasFocus) {
		// Retrieve cell CVE entry
		CVEListEntry entry = (CVEListEntry)value; 
		
		// Update labels
		date.setText(entry.entryDate);
		summary.setText(entry.entrySummary);
		title.setText(entry.entryNumber + " - " + entry.entryScore);
		
		// Set title color based on CVV score
		switch(entry.entryScore){
		case "HIGH": title.setBackground(Color.RED);
		break;
		case "MEDIUM": title.setBackground(Color.YELLOW);
		break;
		case "LOW": title.setBackground(Color.GREEN);
		break;
		case "UNKNOWN": title.setBackground(Color.GRAY);
		break;
		}

		// Change color if cell is selected
		if (isSelected) {
			setBackground(Color.lightGray);
		} else {
			// Create "zebra" effect
			if (index % 2 == 0) setBackground(Color.WHITE);
			else setBackground(new Color(189,221,253));
		}
		return this;
	}

}
