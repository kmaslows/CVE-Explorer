package kamil.cve;

import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.LinkedHashMap;
import java.util.List;

import javax.swing.JButton;

import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;

/**
 * Class implementing ActionListener for navigation buttons in CVEList class
 * @author Kamil Mas³owski
 *
 */
public class CVEListNavButtonAL implements ActionListener {
	
	static Logger log = LogManager.getLogger(); 
	private static final String url_navigation_prefix = "https://web.nvd.nist.gov/view/vuln/";
	private CVEList list;
	private LinkedHashMap<String,String> navButtons;
	
	/**
	 * Navigation button action listener's default constructor.
	 * @param Reference to CVEList object which contains buttons
	 * @param navButtons LinkedHashMap containing parsed navigation data buttons
	 */
	public CVEListNavButtonAL(CVEList list, LinkedHashMap<String,String> navButtons){
		// Store references to outside objects
		this.list = list;
		this.navButtons = navButtons;
		log.debug("Nav button action listener created");
	}
	
	/**
	 * When button is pressed, build full URL for corresponding page and trigger search.
	 */
	public void actionPerformed(ActionEvent e) {
		// get pressed button
		JButton pressedButton = (JButton)e.getSource();
		
		// get button data
		String buttonNumber = pressedButton.getText();
		String buttonURL = (String)navButtons.get(buttonNumber);
		log.info("Button pressed: " + buttonNumber + " URL: " + buttonURL );
		
		// trigger search
		list.runSearch(url_navigation_prefix+buttonURL);
	}
}